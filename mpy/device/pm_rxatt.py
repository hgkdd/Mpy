# -*- coding: utf-8 -*-

import re
import StringIO
import math
from mpy.tools.Configuration import Configuration,strbool,fstrcmp
from scuq import *
from mpy.device import device
from mpy.device.powermeter import POWERMETER as PWRMTR
from mpy.device.nport import NPORT
from mpy.tools.util import locate
from mpy.tools.util import format_block

ini20dBLF=format_block("""
                    [description]
                    DESCRIPTION = 20 dB rx path, LF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = StringIO.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.0          [-20.53, -81.94] [-20.33, -80.94] [-20.13, -79.94]
                                                        1.000000e+07 [-20.53, -81.94] [-20.33, -80.94] [-20.13, -79.94]
                                                        1.038189e+07 [-20.58, -85.65] [-20.38, -84.65] [-20.18, -83.65]
                                                        1.077836e+07 [-20.62, -88.49] [-20.42, -87.49] [-20.22, -86.49]
                                                        1.118997e+07 [-21.01, -92.73] [-20.81, -91.73] [-20.61, -90.73]
                                                        1.161731e+07 [-20.53, -95.44] [-20.33, -94.44] [-20.13, -93.44]
                                                        1.206096e+07 [-20.64, -98.52] [-20.44, -97.52] [-20.24, -96.52]
                                                        1.252155e+07 [-20.62, -103.38] [-20.42, -102.38] [-20.22, -101.38]
                                                        1.299974e+07 [-20.60, -106.14] [-20.40, -105.14] [-20.20, -104.14]
                                                        1.349618e+07 [-20.58, -110.96] [-20.38, -109.96] [-20.18, -108.96]
                                                        1.401158e+07 [-20.54, -115.56] [-20.34, -114.56] [-20.14, -113.56]
                                                        1.454667e+07 [-20.74, -119.25] [-20.54, -118.25] [-20.34, -117.25]
                                                        1.510219e+07 [-20.73, -122.55] [-20.53, -121.55] [-20.33, -120.55]
                                                        1.567893e+07 [-20.56, -128.39] [-20.36, -127.39] [-20.16, -126.39]
                                                        1.627769e+07 [-20.64, -132.49] [-20.44, -131.49] [-20.24, -130.49]
                                                        1.689931e+07 [-20.59, -137.68] [-20.39, -136.68] [-20.19, -135.68]
                                                        1.754468e+07 [-20.56, -143.07] [-20.36, -142.07] [-20.16, -141.07]
                                                        1.821469e+07 [-20.78, -148.55] [-20.58, -147.55] [-20.38, -146.55]
                                                        1.891029e+07 [-20.73, -154.60] [-20.53, -153.60] [-20.33, -152.60]
                                                        1.963245e+07 [-20.74, -160.28] [-20.54, -159.28] [-20.34, -158.28]
                                                        2.038219e+07 [-20.59, -166.56] [-20.39, -165.56] [-20.19, -164.56]
                                                        2.116056e+07 [-20.70, -172.20] [-20.50, -171.20] [-20.30, -170.20]
                                                        2.196866e+07 [-20.63, -179.30] [-20.43, -178.30] [-20.23, -177.30]
                                                        2.280762e+07 [-20.65, 173.98] [-20.45, 174.98] [-20.25, 175.98]
                                                        2.367862e+07 [-20.56, 167.17] [-20.36, 168.17] [-20.16, 169.17]
                                                        2.458288e+07 [-20.65, 159.66] [-20.45, 160.66] [-20.25, 161.66]
                                                        2.552167e+07 [-20.67, 152.42] [-20.47, 153.42] [-20.27, 154.42]
                                                        2.649631e+07 [-20.72, 144.42] [-20.52, 145.42] [-20.32, 146.42]
                                                        2.750818e+07 [-20.68, 136.58] [-20.48, 137.58] [-20.28, 138.58]
                                                        2.855868e+07 [-20.74, 127.90] [-20.54, 128.90] [-20.34, 129.90]
                                                        2.964930e+07 [-20.67, 119.05] [-20.47, 120.05] [-20.27, 121.05]
                                                        3.078158e+07 [-20.75, 110.15] [-20.55, 111.15] [-20.35, 112.15]
                                                        3.195709e+07 [-20.73, 100.28] [-20.53, 101.28] [-20.33, 102.28]
                                                        3.317750e+07 [-20.78, 90.27] [-20.58, 91.27] [-20.38, 92.27]
                                                        3.444451e+07 [-20.76, 80.04] [-20.56, 81.04] [-20.36, 82.04]
                                                        3.575990e+07 [-20.74, 69.61] [-20.54, 70.61] [-20.34, 71.61]
                                                        3.712553e+07 [-20.75, 58.55] [-20.55, 59.55] [-20.35, 60.55]
                                                        3.854331e+07 [-20.80, 47.55] [-20.60, 48.55] [-20.40, 49.55]
                                                        4.001524e+07 [-20.78, 35.55] [-20.58, 36.55] [-20.38, 37.55]
                                                        4.154338e+07 [-20.79, 23.26] [-20.59, 24.26] [-20.39, 25.26]
                                                        4.312987e+07 [-20.79, 10.14] [-20.59, 11.14] [-20.39, 12.14]
                                                        4.477695e+07 [-20.77, -2.77] [-20.57, -1.77] [-20.37, -0.77]
                                                        4.648693e+07 [-20.80, -17.13] [-20.60, -16.13] [-20.40, -15.13]
                                                        4.826221e+07 [-20.76, -31.33] [-20.56, -30.33] [-20.36, -29.33]
                                                        5.010529e+07 [-20.82, -45.97] [-20.62, -44.97] [-20.42, -43.97]
                                                        5.201875e+07 [-20.85, -61.35] [-20.65, -60.35] [-20.45, -59.35]
                                                        5.400529e+07 [-20.82, -77.48] [-20.62, -76.48] [-20.42, -75.48]
                                                        5.606769e+07 [-20.87, -93.94] [-20.67, -92.94] [-20.47, -91.94]
                                                        5.820885e+07 [-20.91, -111.00] [-20.71, -110.00] [-20.51, -109.00]
                                                        6.043178e+07 [-20.81, -129.29] [-20.61, -128.29] [-20.41, -127.29]
                                                        6.273960e+07 [-20.87, -147.90] [-20.67, -146.90] [-20.47, -145.90]
                                                        6.513556e+07 [-20.90, -167.16] [-20.70, -166.16] [-20.50, -165.16]
                                                        6.762301e+07 [-20.93, 173.01] [-20.73, 174.01] [-20.53, 175.01]
                                                        7.020545e+07 [-20.93, 152.31] [-20.73, 153.31] [-20.53, 154.31]
                                                        7.288652e+07 [-20.89, 130.58] [-20.69, 131.58] [-20.49, 132.58]
                                                        7.566997e+07 [-20.91, 108.19] [-20.71, 109.19] [-20.51, 110.19]
                                                        7.855972e+07 [-20.96, 85.19] [-20.76, 86.19] [-20.56, 87.19]
                                                        8.155983e+07 [-20.92, 60.72] [-20.72, 61.72] [-20.52, 62.72]
                                                        8.467450e+07 [-20.96, 35.80] [-20.76, 36.80] [-20.56, 37.80]
                                                        8.790813e+07 [-20.95, 9.76] [-20.75, 10.76] [-20.55, 11.76]
                                                        9.126524e+07 [-20.96, -17.31] [-20.76, -16.31] [-20.56, -15.31]
                                                        9.475055e+07 [-20.97, -45.39] [-20.77, -44.39] [-20.57, -43.39]
                                                        9.836897e+07 [-20.98, -74.54] [-20.78, -73.54] [-20.58, -72.54]
                                                        1.021256e+08 [-21.02, -104.64] [-20.82, -103.64] [-20.62, -102.64]
                                                        1.060256e+08 [-21.01, -136.13] [-20.81, -135.13] [-20.61, -134.13]
                                                        1.100746e+08 [-21.02, -168.61] [-20.82, -167.61] [-20.62, -166.61]
                                                        1.142782e+08 [-21.03, 157.51] [-20.83, 158.51] [-20.63, 159.51]
                                                        1.186424e+08 [-21.05, 122.44] [-20.85, 123.44] [-20.65, 124.44]
                                                        1.231732e+08 [-21.09, 85.97] [-20.89, 86.97] [-20.69, 87.97]
                                                        1.278771e+08 [-21.08, 48.15] [-20.88, 49.15] [-20.68, 50.15]
                                                        1.327605e+08 [-21.09, 8.73] [-20.89, 9.73] [-20.69, 10.73]
                                                        1.378305e+08 [-21.13, -31.94] [-20.93, -30.94] [-20.73, -29.94]
                                                        1.430941e+08 [-21.11, -74.28] [-20.91, -73.28] [-20.71, -72.28]
                                                        1.485587e+08 [-21.12, -118.24] [-20.92, -117.24] [-20.72, -116.24]
                                                        1.542320e+08 [-21.14, -163.90] [-20.94, -162.90] [-20.74, -161.90]
                                                        1.601219e+08 [-21.18, 148.71] [-20.98, 149.71] [-20.78, 150.71]
                                                        1.662368e+08 [-21.18, 99.52] [-20.98, 100.52] [-20.78, 101.52]
                                                        1.725852e+08 [-21.20, 48.43] [-21.00, 49.43] [-20.80, 50.43]
                                                        1.791760e+08 [-21.22, -4.49] [-21.02, -3.49] [-20.82, -2.49]
                                                        1.860186e+08 [-21.22, -59.50] [-21.02, -58.50] [-20.82, -57.50]
                                                        1.931224e+08 [-21.25, -116.63] [-21.05, -115.63] [-20.85, -114.63]
                                                        2.004975e+08 [-21.26, -175.99] [-21.06, -174.99] [-20.86, -173.99]
                                                        2.081543e+08 [-21.29, 122.51] [-21.09, 123.51] [-20.89, 124.51]
                                                        2.161035e+08 [-21.30, 58.65] [-21.10, 59.65] [-20.90, 60.65]
                                                        2.243562e+08 [-21.32, -7.78] [-21.12, -6.78] [-20.92, -5.78]
                                                        2.329241e+08 [-21.34, -76.62] [-21.14, -75.62] [-20.94, -74.62]
                                                        2.418192e+08 [-21.36, -148.12] [-21.16, -147.12] [-20.96, -146.12]
                                                        2.510540e+08 [-21.37, 137.59] [-21.17, 138.59] [-20.97, 139.59]
                                                        2.606415e+08 [-21.39, 60.56] [-21.19, 61.56] [-20.99, 62.56]
                                                        2.705951e+08 [-21.42, -19.49] [-21.22, -18.49] [-21.02, -17.49]
                                                        2.809288e+08 [-21.43, -102.54] [-21.23, -101.54] [-21.03, -100.54]
                                                        2.916571e+08 [-21.46, 171.25] [-21.26, 172.25] [-21.06, 173.25]
                                                        3.027952e+08 [-21.48, 81.73] [-21.28, 82.73] [-21.08, 83.73]
                                                        3.143586e+08 [-21.51, -11.16] [-21.31, -10.16] [-21.11, -9.16]
                                                        3.263636e+08 [-21.53, -107.64] [-21.33, -106.64] [-21.13, -105.64]
                                                        3.388271e+08 [-21.55, 152.20] [-21.35, 153.20] [-21.15, 154.20]
                                                        3.517665e+08 [-21.56, 48.24] [-21.36, 49.24] [-21.16, 50.24]
                                                        3.652000e+08 [-21.59, -59.73] [-21.39, -58.73] [-21.19, -57.73]
                                                        3.791466e+08 [-21.62, -171.77] [-21.42, -170.77] [-21.22, -169.77]
                                                        3.936258e+08 [-21.64, 71.86] [-21.44, 72.86] [-21.24, 73.86]
                                                        4.086579e+08 [-21.67, -48.94] [-21.47, -47.94] [-21.27, -46.94]
                                                        4.242641e+08 [-21.69, -174.32] [-21.49, -173.32] [-21.29, -172.32]
                                                        4.404662e+08 [-21.71, 55.53] [-21.51, 56.53] [-21.31, 57.53]
                                                        4.572871e+08 [-21.74, -79.71] [-21.54, -78.71] [-21.34, -77.71]
                                                        4.747504e+08 [-21.78, 139.98] [-21.58, 140.98] [-21.38, 141.98]
                                                        4.928806e+08 [-21.80, -5.60] [-21.60, -4.60] [-21.40, -3.60]
                                                        5.117031e+08 [-21.82, -156.79] [-21.62, -155.79] [-21.42, -154.79]
                                                        5.312445e+08 [-21.85, 46.10] [-21.65, 47.10] [-21.45, 48.10]
                                                        5.515321e+08 [-21.89, -116.72] [-21.69, -115.72] [-21.49, -114.72]
                                                        5.725945e+08 [-21.92, 74.05] [-21.72, 75.05] [-21.52, 76.05]
                                                        5.944612e+08 [-21.94, -101.60] [-21.74, -100.60] [-21.54, -99.60]
                                                        6.171630e+08 [-21.96, 75.99] [-21.76, 76.99] [-21.56, 77.99]
                                                        6.407317e+08 [-22.01, -113.41] [-21.81, -112.41] [-21.61, -111.41]
                                                        6.652006e+08 [-22.04, 50.08] [-21.84, 51.08] [-21.64, 52.08]
                                                        6.906038e+08 [-22.07, -153.94] [-21.87, -152.94] [-21.67, -151.94]
                                                        7.169772e+08 [-22.09, -5.76] [-21.89, -4.76] [-21.69, -3.76]
                                                        7.443577e+08 [-22.14, 134.38] [-21.94, 135.38] [-21.74, 136.38]
                                                        7.727839e+08 [-22.15, -94.10] [-21.95, -93.10] [-21.75, -92.10]
                                                        8.022956e+08 [-22.19, 28.85] [-21.99, 29.85] [-21.79, 30.85]
                                                        8.329344e+08 [-22.25, 142.87] [-22.05, 143.87] [-21.85, 144.87]
                                                        8.647432e+08 [-22.26, -112.69] [-22.06, -111.69] [-21.86, -110.69]
                                                        8.977667e+08 [-22.32, -17.91] [-22.12, -16.91] [-21.92, -15.91]
                                                        9.320514e+08 [-22.34, 66.85] [-22.14, 67.85] [-21.94, 68.85]
                                                        9.676454e+08 [-22.38, 140.71] [-22.18, 141.71] [-21.98, 142.71]
                                                        1.004599e+09 [-22.45, -155.80] [-22.25, -154.80] [-22.05, -153.80]
                                                        1.042963e+09 [-22.47, -104.03] [-22.27, -103.03] [-22.07, -102.03]
                                                        1.082793e+09 [-22.54, -63.70] [-22.34, -62.70] [-22.14, -61.70]
                                                        1.124143e+09 [-22.53, -35.89] [-22.33, -34.89] [-22.13, -33.89]
                                                        1.167073e+09 [-22.60, -20.59] [-22.40, -19.59] [-22.20, -18.59]
                                                        1.211642e+09 [-22.64, -18.83] [-22.44, -17.83] [-22.24, -16.83]
                                                        1.257913e+09 [-22.71, -29.93] [-22.51, -28.93] [-22.31, -27.93]
                                                        1.305952e+09 [-22.73, -56.03] [-22.53, -55.03] [-22.33, -54.03]
                                                        1.355825e+09 [-22.77, -96.30] [-22.57, -95.30] [-22.37, -94.30]
                                                        1.407602e+09 [-22.84, -152.28] [-22.64, -151.28] [-22.44, -150.28]
                                                        1.461357e+09 [-22.84, 136.24] [-22.64, 137.24] [-22.44, 138.24]
                                                        1.517164e+09 [-22.90, 48.22] [-22.70, 49.22] [-22.50, 50.22]
                                                        1.575103e+09 [-22.99, -57.45] [-22.79, -56.45] [-22.59, -55.45]
                                                        1.635254e+09 [-22.98, -180.22] [-22.78, -179.22] [-22.58, -178.22]
                                                        1.697703e+09 [-23.03, 38.50] [-22.83, 39.50] [-22.63, 40.50]
                                                        1.762536e+09 [-23.16, -122.04] [-22.96, -121.04] [-22.76, -120.04]
                                                        1.829845e+09 [-23.20, 57.22] [-23.00, 58.22] [-22.80, 59.22]
                                                        1.899725e+09 [-23.21, -144.01] [-23.01, -143.01] [-22.81, -142.01]
                                                        1.972273e+09 [-23.24, -6.45] [-23.04, -5.45] [-22.84, -4.45]
                                                        2.047592e+09 [-23.28, 108.94] [-23.08, 109.94] [-22.88, 110.94]
                                                        2.125787e+09 [-23.36, -158.83] [-23.16, -157.83] [-22.96, -156.83]
                                                        2.206969e+09 [-23.46, -90.57] [-23.26, -89.57] [-23.06, -88.57]
                                                        2.291250e+09 [-23.50, -47.29] [-23.30, -46.29] [-23.10, -45.29]
                                                        2.378751e+09 [-23.62, -29.61] [-23.42, -28.61] [-23.22, -27.61]
                                                        2.469592e+09 [-23.60, -39.25] [-23.40, -38.25] [-23.20, -37.25]
                                                        2.563903e+09 [-23.67, -76.21] [-23.47, -75.21] [-23.27, -74.21]
                                                        2.661816e+09 [-23.72, -143.48] [-23.52, -142.48] [-23.32, -141.48]
                                                        2.763468e+09 [-23.94, 120.59] [-23.74, 121.59] [-23.54, 122.59]
                                                        2.869001e+09 [-24.08, -6.42] [-23.88, -5.42] [-23.68, -4.42]
                                                        2.978565e+09 [-24.04, -164.80] [-23.84, -163.80] [-23.64, -162.80]
                                                        3.092313e+09 [-24.12, -0.30] [-23.92, 0.70] [-23.72, 1.70]
                                                        3.210405e+09 [-24.36, 132.96] [-24.16, 133.96] [-23.96, 134.96]
                                                        3.333007e+09 [-24.27, -130.60] [-24.07, -129.60] [-23.87, -128.60]
                                                        3.460290e+09 [-24.65, -73.70] [-24.45, -72.70] [-24.25, -71.70]
                                                        3.592435e+09 [-24.42, -53.04] [-24.22, -52.04] [-24.02, -51.04]
                                                        3.729626e+09 [-24.90, -73.97] [-24.70, -72.97] [-24.50, -71.97]
                                                        3.872056e+09 [-24.80, -139.38] [-24.60, -138.38] [-24.40, -137.38]
                                                        4.019925e+09 [-24.57, 114.91] [-24.37, 115.91] [-24.17, 116.91]
                                                        4.173442e+09 [-24.76, -35.62] [-24.56, -34.62] [-24.36, -33.62]
                                                        4.332821e+09 [-25.03, 125.40] [-24.83, 126.40] [-24.63, 127.40]
                                                        4.498286e+09 [-25.26, -123.85] [-25.06, -122.85] [-24.86, -121.85]
                                                        4.670071e+09 [-25.37, -63.52] [-25.17, -62.52] [-24.97, -61.52]
                                                        4.848415e+09 [-25.35, -55.17] [-25.15, -54.17] [-24.95, -53.17]
                                                        5.033571e+09 [-25.39, -102.59] [-25.19, -101.59] [-24.99, -100.59]
                                                        5.225797e+09 [-25.55, 153.30] [-25.35, 154.30] [-25.15, 155.30]
                                                        5.425364e+09 [-25.99, -6.33] [-25.79, -5.33] [-25.59, -4.33]
                                                        5.632553e+09 [-25.70, 131.98] [-25.50, 132.98] [-25.30, 133.98]
                                                        5.847653e+09 [-25.92, -155.78] [-25.72, -154.78] [-25.52, -153.78]
                                                        6.070969e+09 [-25.58, -148.36] [-25.38, -147.36] [-25.18, -146.36]
                                                        6.302812e+09 [-25.87, 150.97] [-25.67, 151.97] [-25.47, 152.97]
                                                        6.543509e+09 [-26.30, 19.80] [-26.10, 20.80] [-25.90, 21.80]
                                                        6.793398e+09 [-26.10, 172.10] [-25.90, 173.10] [-25.70, 174.10]
                                                        7.052830e+09 [-26.40, -110.90] [-26.20, -109.90] [-26.00, -108.90]
                                                        7.322170e+09 [-26.50, -111.53] [-26.30, -110.53] [-26.10, -109.53]
                                                        7.601795e+09 [-26.29, 162.82] [-26.09, 163.82] [-25.89, 164.82]
                                                        7.892099e+09 [-26.67, -9.74] [-26.47, -8.74] [-26.27, -7.74]
                                                        8.193489e+09 [-26.66, 92.84] [-26.46, 93.84] [-26.26, 94.84]
                                                        8.506389e+09 [-26.98, 101.67] [-26.78, 102.67] [-26.58, 103.67]
                                                        8.831239e+09 [-26.89, 14.68] [-26.69, 15.68] [-26.49, 16.68]
                                                        9.168493e+09 [-27.03, -173.65] [-26.83, -172.65] [-26.63, -171.65]
                                                        9.518628e+09 [-26.92, -106.93] [-26.72, -105.93] [-26.52, -104.93]
                                                        9.882133e+09 [-26.80, -145.78] [-26.60, -144.78] [-26.40, -143.78]
                                                        1.025952e+10 [-26.81, 62.97] [-26.61, 63.97] [-26.41, 64.97]
                                                        1.065132e+10 [-27.33, 160.30] [-27.13, 161.30] [-26.93, 162.30]
                                                        1.105808e+10 [-27.43, 132.40] [-27.23, 133.40] [-27.03, 134.40]
                                                        1.148038e+10 [-27.24, -18.29] [-27.04, -17.29] [-26.84, -16.29]
                                                        1.191880e+10 [-27.48, 59.66] [-27.28, 60.66] [-27.08, 61.66]
                                                        1.237396e+10 [-27.66, 7.58] [-27.46, 8.58] [-27.26, 9.58]
                                                        1.284651e+10 [-27.54, 169.46] [-27.34, 170.46] [-27.14, 171.46]
                                                        1.333711e+10 [-27.41, -168.67] [-27.21, -167.67] [-27.01, -166.67]
                                                        1.384643e+10 [-27.60, 59.97] [-27.40, 60.97] [-27.20, 61.97]
                                                        1.437521e+10 [-28.05, 131.69] [-27.85, 132.69] [-27.65, 133.69]
                                                        1.492419e+10 [-27.72, 41.03] [-27.52, 42.03] [-27.32, 43.03]
                                                        1.549412e+10 [-28.31, 141.17] [-28.11, 142.17] [-27.91, 143.17]
                                                        1.608583e+10 [-28.94, 65.57] [-28.74, 66.57] [-28.54, 67.57]
                                                        1.670013e+10 [-29.09, 173.43] [-28.89, 174.43] [-28.69, 175.43]
                                                        1.733789e+10 [-28.74, 83.92] [-28.54, 84.92] [-28.34, 85.92]
                                                        1.800000e+10 [-29.15, 160.62] [-28.95, 161.62] [-28.75, 162.62]
                                                        '''))
                    """)
ini20dBLF=StringIO.StringIO(ini20dBLF)

ini20dBHF=format_block("""
                    [description]
                    DESCRIPTION = 20 dB rx path, HF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = StringIO.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.0          [-20.66, -75.00] [-20.46, -74.00] [-20.26, -73.00]
                                                        1.000000e+07 [-20.66, -75.00] [-20.46, -74.00] [-20.26, -73.00]
                                                        1.038189e+07 [-20.57, -77.48] [-20.37, -76.48] [-20.17, -75.48]
                                                        1.077836e+07 [-20.59, -79.19] [-20.39, -78.19] [-20.19, -77.19]
                                                        1.118997e+07 [-20.80, -83.77] [-20.60, -82.77] [-20.40, -81.77]
                                                        1.161731e+07 [-20.64, -85.60] [-20.44, -84.60] [-20.24, -83.60]
                                                        1.206096e+07 [-20.60, -89.57] [-20.40, -88.57] [-20.20, -87.57]
                                                        1.252155e+07 [-20.60, -93.30] [-20.40, -92.30] [-20.20, -91.30]
                                                        1.299974e+07 [-20.64, -96.02] [-20.44, -95.02] [-20.24, -94.02]
                                                        1.349618e+07 [-20.57, -99.79] [-20.37, -98.79] [-20.17, -97.79]
                                                        1.401158e+07 [-20.55, -103.86] [-20.35, -102.86] [-20.15, -101.86]
                                                        1.454667e+07 [-20.70, -108.12] [-20.50, -107.12] [-20.30, -106.12]
                                                        1.510219e+07 [-20.77, -111.05] [-20.57, -110.05] [-20.37, -109.05]
                                                        1.567893e+07 [-20.61, -116.03] [-20.41, -115.03] [-20.21, -114.03]
                                                        1.627769e+07 [-20.67, -120.18] [-20.47, -119.18] [-20.27, -118.18]
                                                        1.689931e+07 [-20.59, -124.70] [-20.39, -123.70] [-20.19, -122.70]
                                                        1.754468e+07 [-20.61, -129.32] [-20.41, -128.32] [-20.21, -127.32]
                                                        1.821469e+07 [-20.68, -133.99] [-20.48, -132.99] [-20.28, -131.99]
                                                        1.891029e+07 [-20.66, -139.27] [-20.46, -138.27] [-20.26, -137.27]
                                                        1.963245e+07 [-20.67, -145.21] [-20.47, -144.21] [-20.27, -143.21]
                                                        2.038219e+07 [-20.69, -150.24] [-20.49, -149.24] [-20.29, -148.24]
                                                        2.116056e+07 [-20.69, -155.65] [-20.49, -154.65] [-20.29, -153.65]
                                                        2.196866e+07 [-20.69, -161.99] [-20.49, -160.99] [-20.29, -159.99]
                                                        2.280762e+07 [-20.67, -167.57] [-20.47, -166.57] [-20.27, -165.57]
                                                        2.367862e+07 [-20.67, -174.65] [-20.47, -173.65] [-20.27, -172.65]
                                                        2.458288e+07 [-20.63, -180.87] [-20.43, -179.87] [-20.23, -178.87]
                                                        2.552167e+07 [-20.65, 172.42] [-20.45, 173.42] [-20.25, 174.42]
                                                        2.649631e+07 [-20.68, 165.10] [-20.48, 166.10] [-20.28, 167.10]
                                                        2.750818e+07 [-20.67, 157.90] [-20.47, 158.90] [-20.27, 159.90]
                                                        2.855868e+07 [-20.68, 150.12] [-20.48, 151.12] [-20.28, 152.12]
                                                        2.964930e+07 [-20.65, 142.03] [-20.45, 143.03] [-20.25, 144.03]
                                                        3.078158e+07 [-20.71, 134.19] [-20.51, 135.19] [-20.31, 136.19]
                                                        3.195709e+07 [-20.70, 125.38] [-20.50, 126.38] [-20.30, 127.38]
                                                        3.317750e+07 [-20.72, 116.41] [-20.52, 117.41] [-20.32, 118.41]
                                                        3.444451e+07 [-20.74, 107.13] [-20.54, 108.13] [-20.34, 109.13]
                                                        3.575990e+07 [-20.73, 97.83] [-20.53, 98.83] [-20.33, 99.83]
                                                        3.712553e+07 [-20.74, 87.72] [-20.54, 88.72] [-20.34, 89.72]
                                                        3.854331e+07 [-20.77, 77.57] [-20.57, 78.57] [-20.37, 79.57]
                                                        4.001524e+07 [-20.79, 66.63] [-20.59, 67.63] [-20.39, 68.63]
                                                        4.154338e+07 [-20.77, 55.76] [-20.57, 56.76] [-20.37, 57.76]
                                                        4.312987e+07 [-20.76, 44.08] [-20.56, 45.08] [-20.36, 46.08]
                                                        4.477695e+07 [-20.74, 32.18] [-20.54, 33.18] [-20.34, 34.18]
                                                        4.648693e+07 [-20.77, 19.49] [-20.57, 20.49] [-20.37, 21.49]
                                                        4.826221e+07 [-20.76, 6.59] [-20.56, 7.59] [-20.36, 8.59]
                                                        5.010529e+07 [-20.80, -6.81] [-20.60, -5.81] [-20.40, -4.81]
                                                        5.201875e+07 [-20.83, -20.80] [-20.63, -19.80] [-20.43, -18.80]
                                                        5.400529e+07 [-20.80, -35.08] [-20.60, -34.08] [-20.40, -33.08]
                                                        5.606769e+07 [-20.81, -50.13] [-20.61, -49.13] [-20.41, -48.13]
                                                        5.820885e+07 [-20.84, -65.67] [-20.64, -64.67] [-20.44, -63.67]
                                                        6.043178e+07 [-20.79, -81.98] [-20.59, -80.98] [-20.39, -79.98]
                                                        6.273960e+07 [-20.85, -98.85] [-20.65, -97.85] [-20.45, -96.85]
                                                        6.513556e+07 [-20.88, -116.23] [-20.68, -115.23] [-20.48, -114.23]
                                                        6.762301e+07 [-20.87, -134.28] [-20.67, -133.28] [-20.47, -132.28]
                                                        7.020545e+07 [-20.89, -152.90] [-20.69, -151.90] [-20.49, -150.90]
                                                        7.288652e+07 [-20.88, -172.55] [-20.68, -171.55] [-20.48, -170.55]
                                                        7.566997e+07 [-20.87, 167.32] [-20.67, 168.32] [-20.47, 169.32]
                                                        7.855972e+07 [-20.93, 146.32] [-20.73, 147.32] [-20.53, 148.32]
                                                        8.155983e+07 [-20.90, 124.45] [-20.70, 125.45] [-20.50, 126.45]
                                                        8.467450e+07 [-20.93, 101.73] [-20.73, 102.73] [-20.53, 103.73]
                                                        8.790813e+07 [-20.92, 78.30] [-20.72, 79.30] [-20.52, 80.30]
                                                        9.126524e+07 [-20.93, 53.91] [-20.73, 54.91] [-20.53, 55.91]
                                                        9.475055e+07 [-20.94, 28.55] [-20.74, 29.55] [-20.54, 30.55]
                                                        9.836897e+07 [-20.94, 2.25] [-20.74, 3.25] [-20.54, 4.25]
                                                        1.021256e+08 [-20.97, -24.92] [-20.77, -23.92] [-20.57, -22.92]
                                                        1.060256e+08 [-20.97, -53.47] [-20.77, -52.47] [-20.57, -51.47]
                                                        1.100746e+08 [-20.99, -82.91] [-20.79, -81.91] [-20.59, -80.91]
                                                        1.142782e+08 [-21.00, -113.42] [-20.80, -112.42] [-20.60, -111.42]
                                                        1.186424e+08 [-21.01, -145.03] [-20.81, -144.03] [-20.61, -143.03]
                                                        1.231732e+08 [-21.03, -177.98] [-20.83, -176.98] [-20.63, -175.98]
                                                        1.278771e+08 [-21.03, 147.81] [-20.83, 148.81] [-20.63, 149.81]
                                                        1.327605e+08 [-21.05, 112.29] [-20.85, 113.29] [-20.65, 114.29]
                                                        1.378305e+08 [-21.07, 75.50] [-20.87, 76.50] [-20.67, 77.50]
                                                        1.430941e+08 [-21.07, 37.18] [-20.87, 38.18] [-20.67, 39.18]
                                                        1.485587e+08 [-21.09, -2.43] [-20.89, -1.43] [-20.69, -0.43]
                                                        1.542320e+08 [-21.10, -43.64] [-20.90, -42.64] [-20.70, -41.64]
                                                        1.601219e+08 [-21.12, -86.47] [-20.92, -85.47] [-20.72, -84.47]
                                                        1.662368e+08 [-21.13, -130.88] [-20.93, -129.88] [-20.73, -128.88]
                                                        1.725852e+08 [-21.15, -177.03] [-20.95, -176.03] [-20.75, -175.03]
                                                        1.791760e+08 [-21.16, 135.17] [-20.96, 136.17] [-20.76, 137.17]
                                                        1.860186e+08 [-21.18, 85.44] [-20.98, 86.44] [-20.78, 87.44]
                                                        1.931224e+08 [-21.20, 33.84] [-21.00, 34.84] [-20.80, 35.84]
                                                        2.004975e+08 [-21.22, -19.65] [-21.02, -18.65] [-20.82, -17.65]
                                                        2.081543e+08 [-21.23, -75.28] [-21.03, -74.28] [-20.83, -73.28]
                                                        2.161035e+08 [-21.25, -132.97] [-21.05, -131.97] [-20.85, -130.97]
                                                        2.243562e+08 [-21.25, 167.05] [-21.05, 168.05] [-20.85, 169.05]
                                                        2.329241e+08 [-21.28, 104.84] [-21.08, 105.84] [-20.88, 106.84]
                                                        2.418192e+08 [-21.30, 40.24] [-21.10, 41.24] [-20.90, 42.24]
                                                        2.510540e+08 [-21.31, -26.82] [-21.11, -25.82] [-20.91, -24.82]
                                                        2.606415e+08 [-21.33, -96.42] [-21.13, -95.42] [-20.93, -94.42]
                                                        2.705951e+08 [-21.36, -168.72] [-21.16, -167.72] [-20.96, -166.72]
                                                        2.809288e+08 [-21.38, 116.33] [-21.18, 117.33] [-20.98, 118.33]
                                                        2.916571e+08 [-21.39, 38.47] [-21.19, 39.47] [-20.99, 40.47]
                                                        3.027952e+08 [-21.41, -42.40] [-21.21, -41.40] [-21.01, -40.40]
                                                        3.143586e+08 [-21.44, -126.32] [-21.24, -125.32] [-21.04, -124.32]
                                                        3.263636e+08 [-21.45, 146.51] [-21.25, 147.51] [-21.05, 148.51]
                                                        3.388271e+08 [-21.47, 56.04] [-21.27, 57.04] [-21.07, 58.04]
                                                        3.517665e+08 [-21.50, -37.88] [-21.30, -36.88] [-21.10, -35.88]
                                                        3.652000e+08 [-21.52, -135.35] [-21.32, -134.35] [-21.12, -133.35]
                                                        3.791466e+08 [-21.55, 123.44] [-21.35, 124.44] [-21.15, 125.44]
                                                        3.936258e+08 [-21.58, 18.37] [-21.38, 19.37] [-21.18, 20.37]
                                                        4.086579e+08 [-21.59, -90.64] [-21.39, -89.64] [-21.19, -88.64]
                                                        4.242641e+08 [-21.61, 156.05] [-21.41, 157.05] [-21.21, 158.05]
                                                        4.404662e+08 [-21.63, 38.46] [-21.43, 39.46] [-21.23, 40.46]
                                                        4.572871e+08 [-21.66, -83.66] [-21.46, -82.66] [-21.26, -81.66]
                                                        4.747504e+08 [-21.70, 149.66] [-21.50, 150.66] [-21.30, 151.66]
                                                        4.928806e+08 [-21.72, 18.16] [-21.52, 19.16] [-21.32, 20.16]
                                                        5.117031e+08 [-21.73, -118.46] [-21.53, -117.46] [-21.33, -116.46]
                                                        5.312445e+08 [-21.77, 99.59] [-21.57, 100.59] [-21.37, 101.59]
                                                        5.515321e+08 [-21.83, -47.44] [-21.63, -46.44] [-21.43, -45.44]
                                                        5.725945e+08 [-21.83, 159.87] [-21.63, 160.87] [-21.43, 161.87]
                                                        5.944612e+08 [-21.85, 1.21] [-21.65, 2.21] [-21.45, 3.21]
                                                        6.171630e+08 [-21.87, -163.76] [-21.67, -162.76] [-21.47, -161.76]
                                                        6.407317e+08 [-21.94, 25.46] [-21.74, 26.46] [-21.54, 27.46]
                                                        6.652006e+08 [-21.95, -152.03] [-21.75, -151.03] [-21.55, -150.03]
                                                        6.906038e+08 [-21.96, 23.58] [-21.76, 24.58] [-21.56, 25.58]
                                                        7.169772e+08 [-22.02, -167.72] [-21.82, -166.72] [-21.62, -165.72]
                                                        7.443577e+08 [-22.05, -6.33] [-21.85, -5.33] [-21.65, -4.33]
                                                        7.727839e+08 [-22.04, 147.37] [-21.84, 148.37] [-21.64, 149.37]
                                                        8.022956e+08 [-22.12, -66.60] [-21.92, -65.60] [-21.72, -64.60]
                                                        8.329344e+08 [-22.15, 71.26] [-21.95, 72.26] [-21.75, 73.26]
                                                        8.647432e+08 [-22.16, -159.75] [-21.96, -158.75] [-21.76, -157.75]
                                                        8.977667e+08 [-22.25, -39.33] [-22.05, -38.33] [-21.85, -37.33]
                                                        9.320514e+08 [-22.22, 72.32] [-22.02, 73.32] [-21.82, 74.32]
                                                        9.676454e+08 [-22.29, 173.61] [-22.09, 174.61] [-21.89, 175.61]
                                                        1.004599e+09 [-22.36, -93.57] [-22.16, -92.57] [-21.96, -91.57]
                                                        1.042963e+09 [-22.34, -12.43] [-22.14, -11.43] [-21.94, -10.43]
                                                        1.082793e+09 [-22.45, 59.18] [-22.25, 60.18] [-22.05, 61.18]
                                                        1.124143e+09 [-22.40, 118.76] [-22.20, 119.76] [-22.00, 120.76]
                                                        1.167073e+09 [-22.53, 167.93] [-22.33, 168.93] [-22.13, 169.93]
                                                        1.211642e+09 [-22.49, -155.93] [-22.29, -154.93] [-22.09, -153.93]
                                                        1.257913e+09 [-22.60, -131.03] [-22.40, -130.03] [-22.20, -129.03]
                                                        1.305952e+09 [-22.65, -119.97] [-22.45, -118.97] [-22.25, -117.97]
                                                        1.355825e+09 [-22.67, -120.79] [-22.47, -119.79] [-22.27, -118.79]
                                                        1.407602e+09 [-22.73, -136.94] [-22.53, -135.94] [-22.33, -134.94]
                                                        1.461357e+09 [-22.71, -166.79] [-22.51, -165.79] [-22.31, -164.79]
                                                        1.517164e+09 [-22.84, 149.29] [-22.64, 150.29] [-22.44, 151.29]
                                                        1.575103e+09 [-22.89, 87.96] [-22.69, 88.96] [-22.49, 89.96]
                                                        1.635254e+09 [-22.83, 12.12] [-22.63, 13.12] [-22.43, 14.12]
                                                        1.697703e+09 [-22.91, -80.13] [-22.71, -79.13] [-22.51, -78.13]
                                                        1.762536e+09 [-23.05, 169.59] [-22.85, 170.59] [-22.65, 171.59]
                                                        1.829845e+09 [-23.10, 40.94] [-22.90, 41.94] [-22.70, 42.94]
                                                        1.899725e+09 [-23.06, -105.92] [-22.86, -104.92] [-22.66, -103.92]
                                                        1.972273e+09 [-23.07, 88.39] [-22.87, 89.39] [-22.67, 90.39]
                                                        2.047592e+09 [-23.15, -97.45] [-22.95, -96.45] [-22.75, -95.45]
                                                        2.125787e+09 [-23.27, 55.81] [-23.07, 56.81] [-22.87, 57.81]
                                                        2.206969e+09 [-23.36, -172.94] [-23.16, -171.94] [-22.96, -170.94]
                                                        2.291250e+09 [-23.43, -64.08] [-23.23, -63.08] [-23.03, -62.08]
                                                        2.378751e+09 [-23.52, 21.46] [-23.32, 22.46] [-23.12, 23.46]
                                                        2.469592e+09 [-23.55, 82.80] [-23.35, 83.80] [-23.15, 84.80]
                                                        2.563903e+09 [-23.54, 119.27] [-23.34, 120.27] [-23.14, 121.27]
                                                        2.661816e+09 [-23.53, 128.17] [-23.33, 129.17] [-23.13, 130.17]
                                                        2.763468e+09 [-23.72, 109.94] [-23.52, 110.94] [-23.32, 111.94]
                                                        2.869001e+09 [-24.03, 65.46] [-23.83, 66.46] [-23.63, 67.46]
                                                        2.978565e+09 [-24.09, -6.96] [-23.89, -5.96] [-23.69, -4.96]
                                                        3.092313e+09 [-23.83, -114.08] [-23.63, -113.08] [-23.43, -112.08]
                                                        3.210405e+09 [-24.28, 109.87] [-24.08, 110.87] [-23.88, 111.87]
                                                        3.333007e+09 [-24.20, -56.14] [-24.00, -55.14] [-23.80, -54.14]
                                                        3.460290e+09 [-24.55, 97.57] [-24.35, 98.57] [-24.15, 99.57]
                                                        3.592435e+09 [-24.30, -136.04] [-24.10, -135.04] [-23.90, -134.04]
                                                        3.729626e+09 [-25.05, -53.10] [-24.85, -52.10] [-24.65, -51.10]
                                                        3.872056e+09 [-24.57, -7.90] [-24.37, -6.90] [-24.17, -5.90]
                                                        4.019925e+09 [-24.38, 3.25] [-24.18, 4.25] [-23.98, 5.25]
                                                        4.173442e+09 [-24.73, -28.20] [-24.53, -27.20] [-24.33, -26.20]
                                                        4.332821e+09 [-25.04, -103.94] [-24.84, -102.94] [-24.64, -101.94]
                                                        4.498286e+09 [-25.26, 135.71] [-25.06, 136.71] [-24.86, 137.71]
                                                        4.670071e+09 [-25.45, -30.07] [-25.25, -29.07] [-25.05, -28.07]
                                                        4.848415e+09 [-25.55, 117.47] [-25.35, 118.47] [-25.15, 119.47]
                                                        5.033571e+09 [-25.47, -143.63] [-25.27, -142.63] [-25.07, -141.63]
                                                        5.225797e+09 [-25.09, -98.75] [-24.89, -97.75] [-24.69, -96.75]
                                                        5.425364e+09 [-25.66, -108.14] [-25.46, -107.14] [-25.26, -106.14]
                                                        5.632553e+09 [-25.96, -164.47] [-25.76, -163.47] [-25.56, -162.47]
                                                        5.847653e+09 [-25.51, 72.59] [-25.31, 73.59] [-25.11, 74.59]
                                                        6.070969e+09 [-25.58, -102.47] [-25.38, -101.47] [-25.18, -100.47]
                                                        6.302812e+09 [-26.18, 14.82] [-25.98, 15.82] [-25.78, 16.82]
                                                        6.543509e+09 [-26.08, 67.74] [-25.88, 68.74] [-25.68, 69.74]
                                                        6.793398e+09 [-25.74, 56.39] [-25.54, 57.39] [-25.34, 58.39]
                                                        7.052830e+09 [-26.09, -25.76] [-25.89, -24.76] [-25.69, -23.76]
                                                        7.322170e+09 [-26.54, -177.58] [-26.34, -176.58] [-26.14, -175.58]
                                                        7.601795e+09 [-26.70, -42.65] [-26.50, -41.65] [-26.30, -40.65]
                                                        7.892099e+09 [-26.28, 14.09] [-26.08, 15.09] [-25.88, 16.09]
                                                        8.193489e+09 [-27.16, -13.41] [-26.96, -12.41] [-26.76, -11.41]
                                                        8.506389e+09 [-26.58, -120.43] [-26.38, -119.43] [-26.18, -118.43]
                                                        8.831239e+09 [-26.59, 48.73] [-26.39, 49.73] [-26.19, 50.73]
                                                        9.168493e+09 [-26.73, 123.02] [-26.53, 124.02] [-26.33, 125.02]
                                                        9.518628e+09 [-26.59, 100.55] [-26.39, 101.55] [-26.19, 102.55]
                                                        9.882133e+09 [-26.72, -16.57] [-26.52, -15.57] [-26.32, -14.57]
                                                        1.025952e+10 [-26.73, 128.20] [-26.53, 129.20] [-26.33, 130.20]
                                                        1.065132e+10 [-27.07, 165.68] [-26.87, 166.68] [-26.67, 167.68]
                                                        1.105808e+10 [-26.83, 96.53] [-26.63, 97.53] [-26.43, 98.53]
                                                        1.148038e+10 [-26.87, -83.95] [-26.67, -82.95] [-26.47, -81.95]
                                                        1.191880e+10 [-26.98, -26.16] [-26.78, -25.16] [-26.58, -24.16]
                                                        1.237396e+10 [-27.19, -84.44] [-26.99, -83.44] [-26.79, -82.44]
                                                        1.284651e+10 [-27.25, 86.43] [-27.05, 87.43] [-26.85, 88.43]
                                                        1.333711e+10 [-27.28, 126.55] [-27.08, 127.55] [-26.88, 128.55]
                                                        1.384643e+10 [-27.35, 32.91] [-27.15, 33.91] [-26.95, 34.91]
                                                        1.437521e+10 [-27.73, 152.29] [-27.53, 153.29] [-27.33, 154.29]
                                                        1.492419e+10 [-27.90, 133.51] [-27.70, 134.51] [-27.50, 135.51]
                                                        1.549412e+10 [-28.52, -50.11] [-28.32, -49.11] [-28.12, -48.11]
                                                        1.608583e+10 [-28.73, -25.79] [-28.53, -24.79] [-28.33, -23.79]
                                                        1.670013e+10 [-29.40, -159.82] [-29.20, -158.82] [-29.00, -157.82]
                                                        1.733789e+10 [-28.60, -107.97] [-28.40, -106.97] [-28.20, -105.97]
                                                        1.800000e+10 [-30.00, 128.40] [-29.80, 129.40] [-29.60, 130.40]
                                                        '''))
                    """)
ini20dBHF=StringIO.StringIO(ini20dBHF)

ini0dBHF=format_block("""
                    [description]
                    DESCRIPTION = 0 dB rx path, HF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = StringIO.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.0          [-0.40, -56.83] [-0.20, -55.83] [0.00, -54.83]
                                                        1.000000e+07 [-0.40, -56.83] [-0.20, -55.83] [0.00, -54.83]
                                                        1.038189e+07 [-0.35, -59.06] [-0.15, -58.06] [0.05, -57.06]
                                                        1.077836e+07 [-0.33, -59.85] [-0.13, -58.85] [0.07, -57.85]
                                                        1.118997e+07 [-0.59, -63.98] [-0.39, -62.98] [-0.19, -61.98]
                                                        1.161731e+07 [-0.43, -64.67] [-0.23, -63.67] [-0.03, -62.67]
                                                        1.206096e+07 [-0.32, -67.79] [-0.12, -66.79] [0.08, -65.79]
                                                        1.252155e+07 [-0.33, -70.87] [-0.13, -69.87] [0.07, -68.87]
                                                        1.299974e+07 [-0.35, -72.78] [-0.15, -71.78] [0.05, -70.78]
                                                        1.349618e+07 [-0.32, -76.04] [-0.12, -75.04] [0.08, -74.04]
                                                        1.401158e+07 [-0.27, -78.60] [-0.07, -77.60] [0.13, -76.60]
                                                        1.454667e+07 [-0.45, -82.12] [-0.25, -81.12] [-0.05, -80.12]
                                                        1.510219e+07 [-0.52, -84.13] [-0.32, -83.13] [-0.12, -82.13]
                                                        1.567893e+07 [-0.37, -88.27] [-0.17, -87.27] [0.03, -86.27]
                                                        1.627769e+07 [-0.40, -91.14] [-0.20, -90.14] [0.00, -89.14]
                                                        1.689931e+07 [-0.31, -94.44] [-0.11, -93.44] [0.09, -92.44]
                                                        1.754468e+07 [-0.34, -98.14] [-0.14, -97.14] [0.06, -96.14]
                                                        1.821469e+07 [-0.42, -101.50] [-0.22, -100.50] [-0.02, -99.50]
                                                        1.891029e+07 [-0.40, -105.60] [-0.20, -104.60] [-0.00, -103.60]
                                                        1.963245e+07 [-0.43, -110.16] [-0.23, -109.16] [-0.03, -108.16]
                                                        2.038219e+07 [-0.41, -114.02] [-0.21, -113.02] [-0.01, -112.02]
                                                        2.116056e+07 [-0.41, -117.86] [-0.21, -116.86] [-0.01, -115.86]
                                                        2.196866e+07 [-0.44, -122.78] [-0.24, -121.78] [-0.04, -120.78]
                                                        2.280762e+07 [-0.39, -127.02] [-0.19, -126.02] [0.01, -125.02]
                                                        2.367862e+07 [-0.39, -132.31] [-0.19, -131.31] [0.01, -130.31]
                                                        2.458288e+07 [-0.37, -137.02] [-0.17, -136.02] [0.03, -135.02]
                                                        2.552167e+07 [-0.39, -142.18] [-0.19, -141.18] [0.01, -140.18]
                                                        2.649631e+07 [-0.41, -147.70] [-0.21, -146.70] [-0.01, -145.70]
                                                        2.750818e+07 [-0.40, -153.08] [-0.20, -152.08] [-0.00, -151.08]
                                                        2.855868e+07 [-0.39, -159.01] [-0.19, -158.01] [0.01, -157.01]
                                                        2.964930e+07 [-0.39, -165.28] [-0.19, -164.28] [0.01, -163.28]
                                                        3.078158e+07 [-0.44, -171.17] [-0.24, -170.17] [-0.04, -169.17]
                                                        3.195709e+07 [-0.42, -177.85] [-0.22, -176.85] [-0.02, -175.85]
                                                        3.317750e+07 [-0.43, 175.41] [-0.23, 176.41] [-0.03, 177.41]
                                                        3.444451e+07 [-0.45, 168.35] [-0.25, 169.35] [-0.05, 170.35]
                                                        3.575990e+07 [-0.45, 161.47] [-0.25, 162.47] [-0.05, 163.47]
                                                        3.712553e+07 [-0.44, 153.62] [-0.24, 154.62] [-0.04, 155.62]
                                                        3.854331e+07 [-0.47, 145.95] [-0.27, 146.95] [-0.07, 147.95]
                                                        4.001524e+07 [-0.49, 137.67] [-0.29, 138.67] [-0.09, 139.67]
                                                        4.154338e+07 [-0.47, 129.59] [-0.27, 130.59] [-0.07, 131.59]
                                                        4.312987e+07 [-0.46, 120.66] [-0.26, 121.66] [-0.06, 122.66]
                                                        4.477695e+07 [-0.46, 111.71] [-0.26, 112.71] [-0.06, 113.71]
                                                        4.648693e+07 [-0.48, 101.98] [-0.28, 102.98] [-0.08, 103.98]
                                                        4.826221e+07 [-0.46, 92.23] [-0.26, 93.23] [-0.06, 94.23]
                                                        5.010529e+07 [-0.49, 82.08] [-0.29, 83.08] [-0.09, 84.08]
                                                        5.201875e+07 [-0.51, 71.46] [-0.31, 72.46] [-0.11, 73.46]
                                                        5.400529e+07 [-0.50, 60.71] [-0.30, 61.71] [-0.10, 62.71]
                                                        5.606769e+07 [-0.50, 49.31] [-0.30, 50.31] [-0.10, 51.31]
                                                        5.820885e+07 [-0.52, 37.55] [-0.32, 38.55] [-0.12, 39.55]
                                                        6.043178e+07 [-0.46, 25.15] [-0.26, 26.15] [-0.06, 27.15]
                                                        6.273960e+07 [-0.53, 12.37] [-0.33, 13.37] [-0.13, 14.37]
                                                        6.513556e+07 [-0.55, -0.72] [-0.35, 0.28] [-0.15, 1.28]
                                                        6.762301e+07 [-0.55, -14.43] [-0.35, -13.43] [-0.15, -12.43]
                                                        7.020545e+07 [-0.56, -28.40] [-0.36, -27.40] [-0.16, -26.40]
                                                        7.288652e+07 [-0.54, -43.39] [-0.34, -42.39] [-0.14, -41.39]
                                                        7.566997e+07 [-0.53, -58.64] [-0.33, -57.64] [-0.13, -56.64]
                                                        7.855972e+07 [-0.59, -74.59] [-0.39, -73.59] [-0.19, -72.59]
                                                        8.155983e+07 [-0.57, -91.11] [-0.37, -90.11] [-0.17, -89.11]
                                                        8.467450e+07 [-0.58, -108.36] [-0.38, -107.36] [-0.18, -106.36]
                                                        8.790813e+07 [-0.57, -126.07] [-0.37, -125.07] [-0.17, -124.07]
                                                        9.126524e+07 [-0.58, -144.53] [-0.38, -143.53] [-0.18, -142.53]
                                                        9.475055e+07 [-0.59, -163.73] [-0.39, -162.73] [-0.19, -161.73]
                                                        9.836897e+07 [-0.59, 176.36] [-0.39, 177.36] [-0.19, 178.36]
                                                        1.021256e+08 [-0.61, 155.81] [-0.41, 156.81] [-0.21, 157.81]
                                                        1.060256e+08 [-0.60, 134.18] [-0.40, 135.18] [-0.20, 136.18]
                                                        1.100746e+08 [-0.62, 111.86] [-0.42, 112.86] [-0.22, 113.86]
                                                        1.142782e+08 [-0.63, 88.73] [-0.43, 89.73] [-0.23, 90.73]
                                                        1.186424e+08 [-0.64, 64.84] [-0.44, 65.84] [-0.24, 66.84]
                                                        1.231732e+08 [-0.66, 39.89] [-0.46, 40.89] [-0.26, 41.89]
                                                        1.278771e+08 [-0.65, 13.95] [-0.45, 14.95] [-0.25, 15.95]
                                                        1.327605e+08 [-0.66, -12.96] [-0.46, -11.96] [-0.26, -10.96]
                                                        1.378305e+08 [-0.67, -40.79] [-0.47, -39.79] [-0.27, -38.79]
                                                        1.430941e+08 [-0.67, -69.77] [-0.47, -68.77] [-0.27, -67.77]
                                                        1.485587e+08 [-0.68, -99.79] [-0.48, -98.79] [-0.28, -97.79]
                                                        1.542320e+08 [-0.69, -131.05] [-0.49, -130.05] [-0.29, -129.05]
                                                        1.601219e+08 [-0.71, -163.48] [-0.51, -162.48] [-0.31, -161.48]
                                                        1.662368e+08 [-0.71, 162.90] [-0.51, 163.90] [-0.31, 164.90]
                                                        1.725852e+08 [-0.72, 127.93] [-0.52, 128.93] [-0.32, 129.93]
                                                        1.791760e+08 [-0.73, 91.75] [-0.53, 92.75] [-0.33, 93.75]
                                                        1.860186e+08 [-0.74, 54.08] [-0.54, 55.08] [-0.34, 56.08]
                                                        1.931224e+08 [-0.76, 14.99] [-0.56, 15.99] [-0.36, 16.99]
                                                        2.004975e+08 [-0.77, -25.53] [-0.57, -24.53] [-0.37, -23.53]
                                                        2.081543e+08 [-0.78, -67.69] [-0.58, -66.69] [-0.38, -65.69]
                                                        2.161035e+08 [-0.80, -111.32] [-0.60, -110.32] [-0.40, -109.32]
                                                        2.243562e+08 [-0.79, -156.78] [-0.59, -155.78] [-0.39, -154.78]
                                                        2.329241e+08 [-0.81, 156.10] [-0.61, 157.10] [-0.41, 158.10]
                                                        2.418192e+08 [-0.82, 107.14] [-0.62, 108.14] [-0.42, 109.14]
                                                        2.510540e+08 [-0.83, 56.37] [-0.63, 57.37] [-0.43, 58.37]
                                                        2.606415e+08 [-0.85, 3.70] [-0.65, 4.70] [-0.45, 5.70]
                                                        2.705951e+08 [-0.87, -51.06] [-0.67, -50.06] [-0.47, -49.06]
                                                        2.809288e+08 [-0.87, -107.88] [-0.67, -106.88] [-0.47, -105.88]
                                                        2.916571e+08 [-0.89, -166.84] [-0.69, -165.84] [-0.49, -164.84]
                                                        3.027952e+08 [-0.90, 131.90] [-0.70, 132.90] [-0.50, 133.90]
                                                        3.143586e+08 [-0.92, 68.31] [-0.72, 69.31] [-0.52, 70.31]
                                                        3.263636e+08 [-0.94, 2.31] [-0.74, 3.31] [-0.54, 4.31]
                                                        3.388271e+08 [-0.95, -66.19] [-0.75, -65.19] [-0.55, -64.19]
                                                        3.517665e+08 [-0.96, -137.32] [-0.76, -136.32] [-0.56, -135.32]
                                                        3.652000e+08 [-0.98, 148.82] [-0.78, 149.82] [-0.58, 150.82]
                                                        3.791466e+08 [-0.99, 72.15] [-0.79, 73.15] [-0.59, 74.15]
                                                        3.936258e+08 [-1.02, -7.46] [-0.82, -6.46] [-0.62, -5.46]
                                                        4.086579e+08 [-1.03, -90.04] [-0.83, -89.04] [-0.63, -88.04]
                                                        4.242641e+08 [-1.05, -175.82] [-0.85, -174.82] [-0.65, -173.82]
                                                        4.404662e+08 [-1.06, 95.14] [-0.86, 96.14] [-0.66, 97.14]
                                                        4.572871e+08 [-1.07, 2.69] [-0.87, 3.69] [-0.67, 4.69]
                                                        4.747504e+08 [-1.09, -93.35] [-0.89, -92.35] [-0.69, -91.35]
                                                        4.928806e+08 [-1.11, 167.01] [-0.91, 168.01] [-0.71, 169.01]
                                                        5.117031e+08 [-1.13, 63.55] [-0.93, 64.55] [-0.73, 65.55]
                                                        5.312445e+08 [-1.15, -43.87] [-0.95, -42.87] [-0.75, -41.87]
                                                        5.515321e+08 [-1.18, -155.25] [-0.98, -154.25] [-0.78, -153.25]
                                                        5.725945e+08 [-1.19, 89.04] [-0.99, 90.04] [-0.79, 91.04]
                                                        5.944612e+08 [-1.20, -31.19] [-1.00, -30.19] [-0.80, -29.19]
                                                        6.171630e+08 [-1.22, -156.04] [-1.02, -155.04] [-0.82, -154.04]
                                                        6.407317e+08 [-1.25, 74.54] [-1.05, 75.54] [-0.85, 76.54]
                                                        6.652006e+08 [-1.26, -59.97] [-1.06, -58.97] [-0.86, -57.97]
                                                        6.906038e+08 [-1.30, 160.45] [-1.10, 161.45] [-0.90, 162.45]
                                                        7.169772e+08 [-1.30, 15.60] [-1.10, 16.60] [-0.90, 17.60]
                                                        7.443577e+08 [-1.32, -134.95] [-1.12, -133.95] [-0.92, -132.95]
                                                        7.727839e+08 [-1.35, 68.86] [-1.15, 69.86] [-0.95, 70.86]
                                                        8.022956e+08 [-1.37, -93.21] [-1.17, -92.21] [-0.97, -91.21]
                                                        8.329344e+08 [-1.39, 98.39] [-1.19, 99.39] [-0.99, 100.39]
                                                        8.647432e+08 [-1.43, -76.35] [-1.23, -75.35] [-1.03, -74.35]
                                                        8.977667e+08 [-1.44, 102.14] [-1.24, 103.14] [-1.04, 104.14]
                                                        9.320514e+08 [-1.47, -86.18] [-1.27, -85.18] [-1.07, -84.18]
                                                        9.676454e+08 [-1.49, 78.10] [-1.29, 79.10] [-1.09, 80.10]
                                                        1.004599e+09 [-1.54, -124.70] [-1.34, -123.70] [-1.14, -122.70]
                                                        1.042963e+09 [-1.55, 24.44] [-1.35, 25.44] [-1.15, 26.44]
                                                        1.082793e+09 [-1.57, 165.64] [-1.37, 166.64] [-1.17, 167.64]
                                                        1.124143e+09 [-1.61, -61.61] [-1.41, -60.61] [-1.21, -59.61]
                                                        1.167073e+09 [-1.63, 62.65] [-1.43, 63.65] [-1.23, 64.65]
                                                        1.211642e+09 [-1.67, 177.63] [-1.47, 178.63] [-1.27, 179.63]
                                                        1.257913e+09 [-1.67, -76.45] [-1.47, -75.45] [-1.27, -74.45]
                                                        1.305952e+09 [-1.71, 19.56] [-1.51, 20.56] [-1.31, 21.56]
                                                        1.355825e+09 [-1.78, 105.59] [-1.58, 106.59] [-1.38, 107.59]
                                                        1.407602e+09 [-1.75, -178.78] [-1.55, -177.78] [-1.35, -176.78]
                                                        1.461357e+09 [-1.82, -114.15] [-1.62, -113.15] [-1.42, -112.15]
                                                        1.517164e+09 [-1.86, -60.61] [-1.66, -59.61] [-1.46, -58.61]
                                                        1.575103e+09 [-1.86, -19.18] [-1.66, -18.18] [-1.46, -17.18]
                                                        1.635254e+09 [-1.90, 10.41] [-1.70, 11.41] [-1.50, 12.41]
                                                        1.697703e+09 [-1.94, 27.60] [-1.74, 28.60] [-1.54, 29.60]
                                                        1.762536e+09 [-1.97, 31.36] [-1.77, 32.36] [-1.57, 33.36]
                                                        1.829845e+09 [-2.05, 21.90] [-1.85, 22.90] [-1.65, 23.90]
                                                        1.899725e+09 [-2.05, -2.06] [-1.85, -1.06] [-1.65, -0.06]
                                                        1.972273e+09 [-2.12, -40.49] [-1.92, -39.49] [-1.72, -38.49]
                                                        2.047592e+09 [-2.13, -94.41] [-1.93, -93.41] [-1.73, -92.41]
                                                        2.125787e+09 [-2.21, -163.92] [-2.01, -162.92] [-1.81, -161.92]
                                                        2.206969e+09 [-2.20, 110.33] [-2.00, 111.33] [-1.80, 112.33]
                                                        2.291250e+09 [-2.27, 7.36] [-2.07, 8.36] [-1.87, 9.36]
                                                        2.378751e+09 [-2.27, -113.34] [-2.07, -112.34] [-1.87, -111.34]
                                                        2.469592e+09 [-2.35, 107.65] [-2.15, 108.65] [-1.95, 109.65]
                                                        2.563903e+09 [-2.40, -50.28] [-2.20, -49.28] [-2.00, -48.28]
                                                        2.661816e+09 [-2.43, 132.17] [-2.23, 133.17] [-2.03, 134.17]
                                                        2.763468e+09 [-2.50, -66.36] [-2.30, -65.36] [-2.10, -64.36]
                                                        2.869001e+09 [-2.53, 74.14] [-2.33, 75.14] [-2.13, 76.14]
                                                        2.978565e+09 [-2.59, -167.63] [-2.39, -166.63] [-2.19, -165.63]
                                                        3.092313e+09 [-2.70, -72.29] [-2.50, -71.29] [-2.30, -70.29]
                                                        3.210405e+09 [-2.72, -1.29] [-2.52, -0.29] [-2.32, 0.71]
                                                        3.333007e+09 [-2.74, 45.71] [-2.54, 46.71] [-2.34, 47.71]
                                                        3.460290e+09 [-2.84, 67.14] [-2.64, 68.14] [-2.44, 69.14]
                                                        3.592435e+09 [-2.96, 61.65] [-2.76, 62.65] [-2.56, 63.65]
                                                        3.729626e+09 [-2.93, 27.91] [-2.73, 28.91] [-2.53, 29.91]
                                                        3.872056e+09 [-2.95, -35.15] [-2.75, -34.15] [-2.55, -33.15]
                                                        4.019925e+09 [-3.05, -127.91] [-2.85, -126.91] [-2.65, -125.91]
                                                        4.173442e+09 [-3.26, 109.95] [-3.06, 110.95] [-2.86, 111.95]
                                                        4.332821e+09 [-3.08, -45.56] [-2.88, -44.56] [-2.68, -43.56]
                                                        4.498286e+09 [-3.37, 125.47] [-3.17, 126.47] [-2.97, 127.47]
                                                        4.670071e+09 [-3.32, -95.84] [-3.12, -94.84] [-2.92, -93.84]
                                                        4.848415e+09 [-3.45, 3.18] [-3.25, 4.18] [-3.05, 5.18]
                                                        5.033571e+09 [-3.41, 68.01] [-3.21, 69.01] [-3.01, 70.01]
                                                        5.225797e+09 [-3.41, 91.16] [-3.21, 92.16] [-3.01, 93.16]
                                                        5.425364e+09 [-3.70, 73.80] [-3.50, 74.80] [-3.30, 75.80]
                                                        5.632553e+09 [-3.59, 18.61] [-3.39, 19.61] [-3.19, 20.61]
                                                        5.847653e+09 [-3.60, -83.49] [-3.40, -82.49] [-3.20, -81.49]
                                                        6.070969e+09 [-3.83, 130.41] [-3.63, 131.41] [-3.43, 132.41]
                                                        6.302812e+09 [-3.87, -62.34] [-3.67, -61.34] [-3.47, -60.34]
                                                        6.543509e+09 [-3.94, 55.51] [-3.74, 56.51] [-3.54, 57.51]
                                                        6.793398e+09 [-3.95, 122.58] [-3.75, 123.58] [-3.55, 124.58]
                                                        7.052830e+09 [-4.09, 138.27] [-3.89, 139.27] [-3.69, 140.27]
                                                        7.322170e+09 [-4.18, 98.57] [-3.98, 99.57] [-3.78, 100.57]
                                                        7.601795e+09 [-4.37, 2.99] [-4.17, 3.99] [-3.97, 4.99]
                                                        7.892099e+09 [-4.34, -151.11] [-4.14, -150.11] [-3.94, -149.11]
                                                        8.193489e+09 [-4.48, -6.35] [-4.28, -5.35] [-4.08, -4.35]
                                                        8.506389e+09 [-4.61, 75.70] [-4.41, 76.70] [-4.21, 77.70]
                                                        8.831239e+09 [-4.63, 91.44] [-4.43, 92.44] [-4.23, 93.44]
                                                        9.168493e+09 [-4.80, 39.00] [-4.60, 40.00] [-4.40, 41.00]
                                                        9.518628e+09 [-5.01, -83.69] [-4.81, -82.69] [-4.61, -81.69]
                                                        9.882133e+09 [-5.19, 80.61] [-4.99, 81.61] [-4.79, 82.61]
                                                        1.025952e+10 [-5.22, 169.05] [-5.02, 170.05] [-4.82, 171.05]
                                                        1.065132e+10 [-5.33, 178.17] [-5.13, 179.17] [-4.93, 180.17]
                                                        1.105808e+10 [-5.37, 103.02] [-5.17, 104.02] [-4.97, 105.02]
                                                        1.148038e+10 [-5.40, -56.33] [-5.20, -55.33] [-5.00, -54.33]
                                                        1.191880e+10 [-5.37, 55.07] [-5.17, 56.07] [-4.97, 57.07]
                                                        1.237396e+10 [-5.57, 77.74] [-5.37, 78.74] [-5.17, 79.74]
                                                        1.284651e+10 [-5.71, 1.56] [-5.51, 2.56] [-5.31, 3.56]
                                                        1.333711e+10 [-6.01, -175.20] [-5.81, -174.20] [-5.61, -173.20]
                                                        1.384643e+10 [-6.15, -89.52] [-5.95, -88.52] [-5.75, -87.52]
                                                        1.437521e+10 [-6.39, -113.88] [-6.19, -112.88] [-5.99, -111.88]
                                                        1.492419e+10 [-6.59, 110.21] [-6.39, 111.21] [-6.19, 112.21]
                                                        1.549412e+10 [-6.77, -142.86] [-6.57, -141.86] [-6.37, -140.86]
                                                        1.608583e+10 [-6.83, -152.92] [-6.63, -151.92] [-6.43, -150.92]
                                                        1.670013e+10 [-7.36, 70.90] [-7.16, 71.90] [-6.96, 72.90]
                                                        1.733789e+10 [-7.58, 173.33] [-7.38, 174.33] [-7.18, 175.33]
                                                        1.800000e+10 [-7.19, 136.31] [-6.99, 137.31] [-6.79, 138.31]
                                                        '''))
                    """)
ini0dBHF=StringIO.StringIO(ini0dBHF)

ini0dBLF=format_block("""
                    [description]
                    DESCRIPTION = 0 dB rx path, LF
                    TYPE = NPORT
                    VENDOR = 
                    SERIALNR = 
                    DEVICEID = 
                    DRIVER = nport.py

                    [INIT_VALUE]
                    FSTART = 0
                    FSTOP = 18e9
                    FSTEP = 0.0
                    NR_OF_CHANNELS = 1
                    VIRTUAL = 0

                    [CHANNEL_1]
                    NAME = S21
                    UNIT = dB
                    INTERPOLATION = LOG
                    FILE = StringIO.StringIO(format_block('''
                                                        FUNIT: Hz
                                                        UNIT: dB
                                                        0.0          [-0.37, -65.23] [-0.17, -64.23] [0.03, -63.23]
                                                        1.000000e+07 [-0.37, -65.23] [-0.17, -64.23] [0.03, -63.23]
                                                        1.038189e+07 [-0.36, -67.29] [-0.16, -66.29] [0.04, -65.29]
                                                        1.077836e+07 [-0.33, -68.66] [-0.13, -67.66] [0.07, -66.66]
                                                        1.118997e+07 [-0.61, -72.82] [-0.41, -71.82] [-0.21, -70.82]
                                                        1.161731e+07 [-0.47, -74.24] [-0.27, -73.24] [-0.07, -72.24]
                                                        1.206096e+07 [-0.34, -77.53] [-0.14, -76.53] [0.06, -75.53]
                                                        1.252155e+07 [-0.33, -80.90] [-0.13, -79.90] [0.07, -78.90]
                                                        1.299974e+07 [-0.40, -83.19] [-0.20, -82.19] [-0.00, -81.19]
                                                        1.349618e+07 [-0.34, -86.50] [-0.14, -85.50] [0.06, -84.50]
                                                        1.401158e+07 [-0.29, -90.05] [-0.09, -89.05] [0.11, -88.05]
                                                        1.454667e+07 [-0.43, -93.43] [-0.23, -92.43] [-0.03, -91.43]
                                                        1.510219e+07 [-0.52, -95.94] [-0.32, -94.94] [-0.12, -93.94]
                                                        1.567893e+07 [-0.39, -100.58] [-0.19, -99.58] [0.01, -98.58]
                                                        1.627769e+07 [-0.41, -103.81] [-0.21, -102.81] [-0.01, -101.81]
                                                        1.689931e+07 [-0.30, -107.91] [-0.10, -106.91] [0.10, -105.91]
                                                        1.754468e+07 [-0.36, -112.12] [-0.16, -111.12] [0.04, -110.12]
                                                        1.821469e+07 [-0.44, -116.15] [-0.24, -115.15] [-0.04, -114.15]
                                                        1.891029e+07 [-0.43, -120.54] [-0.23, -119.54] [-0.03, -118.54]
                                                        1.963245e+07 [-0.46, -125.68] [-0.26, -124.68] [-0.06, -123.68]
                                                        2.038219e+07 [-0.43, -129.90] [-0.23, -128.90] [-0.03, -127.90]
                                                        2.116056e+07 [-0.42, -134.57] [-0.22, -133.57] [-0.02, -132.57]
                                                        2.196866e+07 [-0.46, -140.17] [-0.26, -139.17] [-0.06, -138.17]
                                                        2.280762e+07 [-0.41, -145.07] [-0.21, -144.07] [-0.01, -143.07]
                                                        2.367862e+07 [-0.41, -151.03] [-0.21, -150.03] [-0.01, -149.03]
                                                        2.458288e+07 [-0.41, -156.52] [-0.21, -155.52] [-0.01, -154.52]
                                                        2.552167e+07 [-0.42, -162.28] [-0.22, -161.28] [-0.02, -160.28]
                                                        2.649631e+07 [-0.43, -168.69] [-0.23, -167.69] [-0.03, -166.69]
                                                        2.750818e+07 [-0.42, -174.74] [-0.22, -173.74] [-0.02, -172.74]
                                                        2.855868e+07 [-0.42, 178.45] [-0.22, 179.45] [-0.02, 180.45]
                                                        2.964930e+07 [-0.40, 171.33] [-0.20, 172.33] [-0.00, 173.33]
                                                        3.078158e+07 [-0.46, 164.68] [-0.26, 165.68] [-0.06, 166.68]
                                                        3.195709e+07 [-0.44, 156.99] [-0.24, 157.99] [-0.04, 158.99]
                                                        3.317750e+07 [-0.46, 149.23] [-0.26, 150.23] [-0.06, 151.23]
                                                        3.444451e+07 [-0.47, 141.22] [-0.27, 142.22] [-0.07, 143.22]
                                                        3.575990e+07 [-0.47, 133.24] [-0.27, 134.24] [-0.07, 135.24]
                                                        3.712553e+07 [-0.48, 124.37] [-0.28, 125.37] [-0.08, 126.37]
                                                        3.854331e+07 [-0.51, 115.68] [-0.31, 116.68] [-0.11, 117.68]
                                                        4.001524e+07 [-0.52, 106.19] [-0.32, 107.19] [-0.12, 108.19]
                                                        4.154338e+07 [-0.50, 96.92] [-0.30, 97.92] [-0.10, 98.92]
                                                        4.312987e+07 [-0.49, 86.70] [-0.29, 87.70] [-0.09, 88.70]
                                                        4.477695e+07 [-0.48, 76.50] [-0.28, 77.50] [-0.08, 78.50]
                                                        4.648693e+07 [-0.49, 65.43] [-0.29, 66.43] [-0.09, 67.43]
                                                        4.826221e+07 [-0.49, 54.26] [-0.29, 55.26] [-0.09, 56.26]
                                                        5.010529e+07 [-0.51, 42.68] [-0.31, 43.68] [-0.11, 44.68]
                                                        5.201875e+07 [-0.54, 30.55] [-0.34, 31.55] [-0.14, 32.55]
                                                        5.400529e+07 [-0.52, 18.27] [-0.32, 19.27] [-0.12, 20.27]
                                                        5.606769e+07 [-0.53, 5.27] [-0.33, 6.27] [-0.13, 7.27]
                                                        5.820885e+07 [-0.55, -8.23] [-0.35, -7.23] [-0.15, -6.23]
                                                        6.043178e+07 [-0.49, -22.40] [-0.29, -21.40] [-0.09, -20.40]
                                                        6.273960e+07 [-0.56, -36.94] [-0.36, -35.94] [-0.16, -34.94]
                                                        6.513556e+07 [-0.58, -51.95] [-0.38, -50.95] [-0.18, -49.95]
                                                        6.762301e+07 [-0.58, -67.54] [-0.38, -66.54] [-0.18, -65.54]
                                                        7.020545e+07 [-0.59, -83.61] [-0.39, -82.61] [-0.19, -81.61]
                                                        7.288652e+07 [-0.58, -100.70] [-0.38, -99.70] [-0.18, -98.70]
                                                        7.566997e+07 [-0.57, -118.08] [-0.37, -117.08] [-0.17, -116.08]
                                                        7.855972e+07 [-0.63, -136.30] [-0.43, -135.30] [-0.23, -134.30]
                                                        8.155983e+07 [-0.60, -155.22] [-0.40, -154.22] [-0.20, -153.22]
                                                        8.467450e+07 [-0.63, -174.88] [-0.43, -173.88] [-0.23, -172.88]
                                                        8.790813e+07 [-0.61, 164.87] [-0.41, 165.87] [-0.21, 166.87]
                                                        9.126524e+07 [-0.63, 143.78] [-0.43, 144.78] [-0.23, 145.78]
                                                        9.475055e+07 [-0.62, 121.87] [-0.42, 122.87] [-0.22, 123.87]
                                                        9.836897e+07 [-0.64, 99.11] [-0.44, 100.11] [-0.24, 101.11]
                                                        1.021256e+08 [-0.65, 75.64] [-0.45, 76.64] [-0.25, 77.64]
                                                        1.060256e+08 [-0.65, 50.93] [-0.45, 51.93] [-0.25, 52.93]
                                                        1.100746e+08 [-0.66, 25.43] [-0.46, 26.43] [-0.26, 27.43]
                                                        1.142782e+08 [-0.67, -0.99] [-0.47, 0.01] [-0.27, 1.01]
                                                        1.186424e+08 [-0.69, -28.28] [-0.49, -27.28] [-0.29, -26.28]
                                                        1.231732e+08 [-0.71, -56.78] [-0.51, -55.78] [-0.31, -54.78]
                                                        1.278771e+08 [-0.70, -86.42] [-0.50, -85.42] [-0.30, -84.42]
                                                        1.327605e+08 [-0.71, -117.14] [-0.51, -116.14] [-0.31, -115.14]
                                                        1.378305e+08 [-0.72, -148.97] [-0.52, -147.97] [-0.32, -146.97]
                                                        1.430941e+08 [-0.72, 177.91] [-0.52, 178.91] [-0.32, 179.91]
                                                        1.485587e+08 [-0.74, 143.64] [-0.54, 144.64] [-0.34, 145.64]
                                                        1.542320e+08 [-0.75, 107.95] [-0.55, 108.95] [-0.35, 109.95]
                                                        1.601219e+08 [-0.76, 70.88] [-0.56, 71.88] [-0.36, 72.88]
                                                        1.662368e+08 [-0.77, 32.48] [-0.57, 33.48] [-0.37, 34.48]
                                                        1.725852e+08 [-0.78, -7.43] [-0.58, -6.43] [-0.38, -5.43]
                                                        1.791760e+08 [-0.79, -48.76] [-0.59, -47.76] [-0.39, -46.76]
                                                        1.860186e+08 [-0.80, -91.81] [-0.60, -90.81] [-0.40, -89.81]
                                                        1.931224e+08 [-0.82, -136.50] [-0.62, -135.50] [-0.42, -134.50]
                                                        2.004975e+08 [-0.84, 177.22] [-0.64, 178.22] [-0.44, 179.22]
                                                        2.081543e+08 [-0.85, 129.07] [-0.65, 130.07] [-0.45, 131.07]
                                                        2.161035e+08 [-0.86, 79.21] [-0.66, 80.21] [-0.46, 81.21]
                                                        2.243562e+08 [-0.86, 27.29] [-0.66, 28.29] [-0.46, 29.29]
                                                        2.329241e+08 [-0.89, -26.55] [-0.69, -25.55] [-0.49, -24.55]
                                                        2.418192e+08 [-0.90, -82.48] [-0.70, -81.48] [-0.50, -80.48]
                                                        2.510540e+08 [-0.91, -140.46] [-0.71, -139.46] [-0.51, -138.46]
                                                        2.606415e+08 [-0.93, 159.35] [-0.73, 160.35] [-0.53, 161.35]
                                                        2.705951e+08 [-0.94, 96.79] [-0.74, 97.79] [-0.54, 98.79]
                                                        2.809288e+08 [-0.96, 31.90] [-0.76, 32.90] [-0.56, 33.90]
                                                        2.916571e+08 [-0.98, -35.44] [-0.78, -34.44] [-0.58, -33.44]
                                                        3.027952e+08 [-0.98, -105.41] [-0.78, -104.41] [-0.58, -103.41]
                                                        3.143586e+08 [-1.00, -178.03] [-0.80, -177.03] [-0.60, -176.03]
                                                        3.263636e+08 [-1.02, 106.52] [-0.82, 107.52] [-0.62, 108.52]
                                                        3.388271e+08 [-1.04, 28.30] [-0.84, 29.30] [-0.64, 30.30]
                                                        3.517665e+08 [-1.05, -53.00] [-0.85, -52.00] [-0.65, -51.00]
                                                        3.652000e+08 [-1.07, -137.39] [-0.87, -136.39] [-0.67, -135.39]
                                                        3.791466e+08 [-1.09, 135.12] [-0.89, 136.12] [-0.69, 137.12]
                                                        3.936258e+08 [-1.10, 44.11] [-0.90, 45.11] [-0.70, 46.11]
                                                        4.086579e+08 [-1.12, -50.27] [-0.92, -49.27] [-0.72, -48.27]
                                                        4.242641e+08 [-1.14, -148.29] [-0.94, -147.29] [-0.74, -146.29]
                                                        4.404662e+08 [-1.17, 109.97] [-0.97, 110.97] [-0.77, 111.97]
                                                        4.572871e+08 [-1.19, 4.47] [-0.99, 5.47] [-0.79, 6.47]
                                                        4.747504e+08 [-1.19, -105.16] [-0.99, -104.16] [-0.79, -103.16]
                                                        4.928806e+08 [-1.22, 140.97] [-1.02, 141.97] [-0.82, 142.97]
                                                        5.117031e+08 [-1.23, 22.75] [-1.03, 23.75] [-0.83, 24.75]
                                                        5.312445e+08 [-1.25, -100.01] [-1.05, -99.01] [-0.85, -98.01]
                                                        5.515321e+08 [-1.28, 132.72] [-1.08, 133.72] [-0.88, 134.72]
                                                        5.725945e+08 [-1.30, 0.50] [-1.10, 1.50] [-0.90, 2.50]
                                                        5.944612e+08 [-1.31, -136.78] [-1.11, -135.78] [-0.91, -134.78]
                                                        6.171630e+08 [-1.33, 80.64] [-1.13, 81.64] [-0.93, 82.64]
                                                        6.407317e+08 [-1.36, -67.32] [-1.16, -66.32] [-0.96, -65.32]
                                                        6.652006e+08 [-1.38, 139.05] [-1.18, 140.05] [-0.98, 141.05]
                                                        6.906038e+08 [-1.40, -20.48] [-1.20, -19.48] [-1.00, -18.48]
                                                        7.169772e+08 [-1.43, 173.97] [-1.23, 174.97] [-1.03, 175.97]
                                                        7.443577e+08 [-1.47, 2.07] [-1.27, 3.07] [-1.07, 4.07]
                                                        7.727839e+08 [-1.48, -176.29] [-1.28, -175.29] [-1.08, -174.29]
                                                        8.022956e+08 [-1.50, -1.52] [-1.30, -0.52] [-1.10, 0.48]
                                                        8.329344e+08 [-1.53, 166.12] [-1.33, 167.12] [-1.13, 168.12]
                                                        8.647432e+08 [-1.57, -33.60] [-1.37, -32.60] [-1.17, -31.60]
                                                        8.977667e+08 [-1.59, 119.10] [-1.39, 120.10] [-1.19, 121.10]
                                                        9.320514e+08 [-1.62, -95.98] [-1.42, -94.98] [-1.22, -93.98]
                                                        9.676454e+08 [-1.63, 40.53] [-1.43, 41.53] [-1.23, 42.53]
                                                        1.004599e+09 [-1.66, 168.50] [-1.46, 169.50] [-1.26, 170.50]
                                                        1.042963e+09 [-1.72, -72.29] [-1.52, -71.29] [-1.32, -70.29]
                                                        1.082793e+09 [-1.74, 37.78] [-1.54, 38.78] [-1.34, 39.78]
                                                        1.124143e+09 [-1.77, 138.19] [-1.57, 139.19] [-1.37, 140.19]
                                                        1.167073e+09 [-1.80, -131.33] [-1.60, -130.33] [-1.40, -129.33]
                                                        1.211642e+09 [-1.88, -51.05] [-1.68, -50.05] [-1.48, -49.05]
                                                        1.257913e+09 [-1.88, 18.85] [-1.68, 19.85] [-1.48, 20.85]
                                                        1.305952e+09 [-1.89, 77.05] [-1.69, 78.05] [-1.49, 79.05]
                                                        1.355825e+09 [-1.96, 124.10] [-1.76, 125.10] [-1.56, 126.10]
                                                        1.407602e+09 [-1.98, 159.37] [-1.78, 160.37] [-1.58, 161.37]
                                                        1.461357e+09 [-1.99, -178.19] [-1.79, -177.19] [-1.59, -176.19]
                                                        1.517164e+09 [-2.06, -168.62] [-1.86, -167.62] [-1.66, -166.62]
                                                        1.575103e+09 [-2.08, -172.12] [-1.88, -171.12] [-1.68, -170.12]
                                                        1.635254e+09 [-2.12, 170.21] [-1.92, 171.21] [-1.72, 172.21]
                                                        1.697703e+09 [-2.22, 138.51] [-2.02, 139.51] [-1.82, 140.51]
                                                        1.762536e+09 [-2.18, 91.71] [-1.98, 92.71] [-1.78, 93.71]
                                                        1.829845e+09 [-2.31, 29.24] [-2.11, 30.24] [-1.91, 31.24]
                                                        1.899725e+09 [-2.29, -49.00] [-2.09, -48.00] [-1.89, -47.00]
                                                        1.972273e+09 [-2.35, -144.99] [-2.15, -143.99] [-1.95, -142.99]
                                                        2.047592e+09 [-2.43, 102.89] [-2.23, 103.89] [-2.03, 104.89]
                                                        2.125787e+09 [-2.49, -28.35] [-2.29, -27.35] [-2.09, -26.35]
                                                        2.206969e+09 [-2.54, -176.98] [-2.34, -175.98] [-2.14, -174.98]
                                                        2.291250e+09 [-2.61, 13.30] [-2.41, 14.30] [-2.21, 15.30]
                                                        2.378751e+09 [-2.64, -174.93] [-2.44, -173.93] [-2.24, -172.93]
                                                        2.469592e+09 [-2.80, -25.68] [-2.60, -24.68] [-2.40, -23.68]
                                                        2.563903e+09 [-2.70, 103.11] [-2.50, 104.11] [-2.30, 105.11]
                                                        2.661816e+09 [-2.96, -151.23] [-2.76, -150.23] [-2.56, -149.23]
                                                        2.763468e+09 [-2.91, -69.78] [-2.71, -68.78] [-2.51, -67.78]
                                                        2.869001e+09 [-2.93, -10.64] [-2.73, -9.64] [-2.53, -8.64]
                                                        2.978565e+09 [-3.18, 21.80] [-2.98, 22.80] [-2.78, 23.80]
                                                        3.092313e+09 [-3.15, 27.07] [-2.95, 28.07] [-2.75, 29.07]
                                                        3.210405e+09 [-3.12, 7.03] [-2.92, 8.03] [-2.72, 9.03]
                                                        3.333007e+09 [-3.33, -41.31] [-3.13, -40.31] [-2.93, -39.31]
                                                        3.460290e+09 [-3.46, -119.98] [-3.26, -118.98] [-3.06, -117.98]
                                                        3.592435e+09 [-3.42, 130.01] [-3.22, 131.01] [-3.02, 132.01]
                                                        3.729626e+09 [-3.45, -10.88] [-3.25, -9.88] [-3.05, -8.88]
                                                        3.872056e+09 [-3.41, 176.24] [-3.21, 177.24] [-3.01, 178.24]
                                                        4.019925e+09 [-3.42, -31.77] [-3.22, -30.77] [-3.02, -29.77]
                                                        4.173442e+09 [-3.69, 84.93] [-3.49, 85.93] [-3.29, 86.93]
                                                        4.332821e+09 [-3.57, 166.04] [-3.37, 167.04] [-3.17, 168.04]
                                                        4.498286e+09 [-3.71, -153.67] [-3.51, -152.67] [-3.31, -151.67]
                                                        4.670071e+09 [-4.07, -150.57] [-3.87, -149.57] [-3.67, -148.57]
                                                        4.848415e+09 [-3.82, 169.36] [-3.62, 170.36] [-3.42, 171.36]
                                                        5.033571e+09 [-4.57, 86.59] [-4.37, 87.59] [-4.17, 88.59]
                                                        5.225797e+09 [-4.23, -36.21] [-4.03, -35.21] [-3.83, -34.21]
                                                        5.425364e+09 [-4.51, 150.24] [-4.31, 151.24] [-4.11, 152.24]
                                                        5.632553e+09 [-4.49, -68.21] [-4.29, -67.21] [-4.09, -66.21]
                                                        5.847653e+09 [-4.74, 20.56] [-4.54, 21.56] [-4.34, 22.56]
                                                        6.070969e+09 [-4.51, 63.00] [-4.31, 64.00] [-4.11, 65.00]
                                                        6.302812e+09 [-5.02, 44.14] [-4.82, 45.14] [-4.62, 46.14]
                                                        6.543509e+09 [-4.69, -20.94] [-4.49, -19.94] [-4.29, -18.94]
                                                        6.793398e+09 [-5.29, -152.01] [-5.09, -151.01] [-4.89, -150.01]
                                                        7.052830e+09 [-4.94, 21.64] [-4.74, 22.64] [-4.54, 23.64]
                                                        7.322170e+09 [-5.65, 132.62] [-5.45, 133.62] [-5.25, 134.62]
                                                        7.601795e+09 [-5.71, 174.69] [-5.51, 175.69] [-5.31, 176.69]
                                                        7.892099e+09 [-5.57, 153.78] [-5.37, 154.78] [-5.17, 155.78]
                                                        8.193489e+09 [-5.56, 63.60] [-5.36, 64.60] [-5.16, 65.60]
                                                        8.506389e+09 [-5.72, -97.34] [-5.52, -96.34] [-5.32, -95.34]
                                                        8.831239e+09 [-6.09, 22.78] [-5.89, 23.78] [-5.69, 24.78]
                                                        9.168493e+09 [-6.67, 66.60] [-6.47, 67.60] [-6.27, 68.60]
                                                        9.518628e+09 [-7.42, 28.42] [-7.22, 29.42] [-7.02, 30.42]
                                                        9.882133e+09 [-8.08, -85.57] [-7.88, -84.57] [-7.68, -83.57]
                                                        1.025952e+10 [-7.93, 72.74] [-7.73, 73.74] [-7.53, 74.74]
                                                        1.065132e+10 [-8.26, 135.79] [-8.06, 136.79] [-7.86, 137.79]
                                                        1.105808e+10 [-7.44, 105.86] [-7.24, 106.86] [-7.04, 107.86]
                                                        1.148038e+10 [-7.85, -21.36] [-7.65, -20.36] [-7.45, -19.36]
                                                        1.191880e+10 [-7.11, 102.07] [-6.91, 103.07] [-6.71, 104.07]
                                                        1.237396e+10 [-6.65, 126.24] [-6.45, 127.24] [-6.25, 128.24]
                                                        1.284651e+10 [-6.98, 41.12] [-6.78, 42.12] [-6.58, 43.12]
                                                        1.333711e+10 [-7.60, -158.66] [-7.40, -157.66] [-7.20, -156.66]
                                                        1.384643e+10 [-8.22, -115.54] [-8.02, -114.54] [-7.82, -113.54]
                                                        1.437521e+10 [-9.19, 163.35] [-8.99, 164.35] [-8.79, 165.35]
                                                        1.492419e+10 [-8.26, -32.04] [-8.06, -31.04] [-7.86, -30.04]
                                                        1.549412e+10 [-10.13, -17.75] [-9.93, -16.75] [-9.73, -15.75]
                                                        1.608583e+10 [-10.49, -139.14] [-10.29, -138.14] [-10.09, -137.14]
                                                        1.670013e+10 [-12.19, -10.94] [-11.99, -9.94] [-11.79, -8.94]
                                                        1.733789e+10 [-10.17, -40.03] [-9.97, -39.03] [-9.77, -38.03]
                                                        1.800000e+10 [-10.75, 109.23] [-10.55, 110.23] [-10.35, 111.23]
                                                        '''))
                    """)
ini0dBLF=StringIO.StringIO(ini0dBLF)


class POWERMETER(PWRMTR):
    conftmpl=PWRMTR.conftmpl
    conftmpl['description']['pmini'] = str

    _FP=r'[-+]?(\d+(\.\d*)?|\d*\.\d+)([eE][-+]?\d+)?'
        
    def __init__(self, **kw):
        self.SearchPaths=kw.get('SearchPaths', ['.'])
        if self.SearchPaths == None:
            self.SearchPaths=['.']
        self.pm_instance = None
        self.freq= None
        self.power=None
        self.unit=None
        self._internal_unit='dBm'
        self.np20L=NPORT()
        self.np20L.Init(ini20dBLF)
        self.np20H=NPORT()
        self.np20H.Init(ini20dBHF)
        self.np0L=NPORT()
        self.np0L.Init(ini0dBLF)
        self.np0H=NPORT()
        self.np0H.Init(ini0dBHF)
        self.swfreq=1e9
        self.att20=None
        self.att0=None
        self.np20=None
        self.np0=None
        self.pfac=None
                   
    def Init(self, ininame, ch=1):
        self.conf=Configuration(ininame, self.conftmpl).conf
        pmini=self.conf['description']['pmini']
        pmini=locate(pmini, paths=self.SearchPaths).next()
        self.pm_instance=getattr(device, 'Powermeter')(SearchPaths=self.SearchPaths)
        stat = self.pm_instance.Init(pmini, ch)
        methods = ('Quit',
                   'SetVirtual',
                   'GetVirtual',
                   'Trigger',
                   'Zero')
        for m in methods:
            setattr(self, m, getattr(self.pm_instance, m))
        return stat

    def GetData(self):
        self.error, obj = self.pm_instance.GetData()
        return self.error, obj

    def GetDataNB(self, retrigger):
        self.error, obj = self.pm_instance.GetDataNB(retrigger)
        if obj:
            pass
        return self.error, obj

    def SetFreq(self, freq):
        self.error, rfreq = self.pm_instance.SetFreq(freq)
        assert rfreq==freq
        self.freq = freq
        if freq <= self.swfreq:
            ext='L'
        else:
            ext='H'
        for s in (0, 20):
            setattr(self, 'np%d'%s, getattr(self, 'np%d%s'%(s,ext)))
        self.np20.SetFreq(freq)
        self.np0.SetFreq(freq)
        err, self.att20 = self.np20.GetData(what='S21')
        err, self.att0  = self.np0.GetData(what='S21')
        self.pfac=abs(self.att0/self.att20).get_expectation_value_as_float()
        print freq, abs(self.att0), abs(self.att20), self.pfac
        return self.error, freq
        
    def GetDescription(self):
        self.error, pm_des = self.pm_instance.GetDescription()  
        return self.error, str(self.conf['description'])+pm_des
        

        
        
def test_init(ch):
    import StringIO
    from mpy.tools.util import format_block
    inst=POWERMETER()
    ini=format_block("""
                    [DESCRIPTION]
                    description: add 20 dB to power meter
                    type:        POWERMETER
                    vendor:      TUDD
                    pmini: pmini.ini
                    driver: pm_rxatt.py

                    [Init_Value]
                    fstart: 100e3
                    fstop: 18e9
                    fstep: 1
                    virtual: 0
                    nr_of_channels: 1
                    
                    [Channel_1]
                    name: A
                    unit: dBm
                    """)
    ini=StringIO.StringIO(ini)


    ini_pm=format_block("""
                    [DESCRIPTION]
                    description: 'GigaTronics 8542C Universal Power Meter'
                    type:        'POWERMETER'
                    vendor:      'GigaTronics'
                    serialnr:
                    deviceid:
                    driver: 'pm_gt_8540c.py'

                    [Init_Value]
                    fstart: 100e3
                    fstop: 18e9
                    fstep: 1
                    gpib: 13
                    virtual: 0
                    nr_of_channels: 2

                    [Channel_1]
                    name: A
                    unit: dBm
                    filter: -1
                    #resolution: 
                    rangemode: auto
                    #manrange: 
                    swr: 1.1
                    trg_threshold: 0.5

                    [Channel_2]
                    name: B
                    unit: 'W'
                    trg_threshold: 0.5
                    """)
    ini_pm=StringIO.StringIO(ini_pm)
    inst.Init(ini,ch)
    return inst
            
def main():
    import StringIO
    from mpy.tools.util import format_block
    from mpy.device.powermeter_ui import UI as UI

    try:
        ini=sys.argv[1]
    except IndexError:
        ini=format_block("""
                        [DESCRIPTION]
                        description: 'GigaTronics 8542C Universal Power Meter'
                        type:        'POWERMETER'
                        vendor:      'GigaTronics'
                        serialnr:
                        deviceid:
                        driver:

                        [Init_Value]
                        fstart: 100e3
                        fstop: 18e9
                        fstep: 1
                        gpib: 13
                        virtual: 0
                        nr_of_channels: 2

                        [Channel_1]
                        name: A
                        unit: dBm
                        filter: -1
                        #resolution: 
                        rangemode: auto
                        #manrange: 
                        swr: 1.1
                        trg_threshold: 0.5

                        [Channel_2]
                        name: B
                        unit: 'W'
                        trg_threshold: 0.5
                        """)
        ini=StringIO.StringIO(ini)

    pm=POWERMETER()	
    ui=UI(pm,ini=ini)
    ui.configure_traits()
    
if __name__ == '__main__':
#    main()
    pm1=test_init(1)
    for f in (0, 10e8, 5e9):
        pm1.SetFreq(f)
        pm1.Trigger()
        print f, pm1.GetData()
    pm1.Quit()
